<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>A La Pierre â€” Reservations</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body { background:#f7f5f2; }
.red-nav { background:#8b0000; }
.hero {
  min-height:45vh;
  background:
    linear-gradient(rgba(0,0,0,.45), rgba(0,0,0,.45)),
    url("https://images.unsplash.com/photo-1504674900247-0877df9cc836");
  background-size:cover;
  background-position:center;
  color:white;
  display:flex;
  align-items:center;
  text-align:center;
}
.card { border-radius:18px; }
.red-footer { background:#8b0000; }
.map iframe { border-radius:18px; }
</style>
</head>

<body class="d-flex flex-column min-vh-100">

<nav class="navbar navbar-dark red-nav">
<div class="container d-flex justify-content-between">
<span class="navbar-brand">ğŸ½ï¸ A La Pierre</span>
<a href="index.html" class="btn btn-outline-light">ğŸ  Home</a>
<a class="nav-link text-white" href="myReservations.html">My Reservations</a>
</div>
</nav>

<section class="hero">
<div class="container">
<h1 class="display-4 fw-bold">Reserve Your Table</h1>
<p class="lead">Open 10:00 â€“ 24:00</p>
</div>
</section>

<section class="container py-5">
<div class="row g-4">

<!-- FORM -->
<div class="col-md-6">
<div class="card p-4 shadow-sm">

<h4>Reservation</h4>

<form onsubmit="event.preventDefault(); reserve();">

<input type="date" id="date" class="form-control mb-3" required>

<input type="time" id="time" class="form-control mb-3" required>

<select id="guests" class="form-control mb-3">
<option value="1">1 Guest</option>
<option value="2">2 Guests</option>
<option value="3">3 Guests</option>
<option value="4">4 Guests</option>
<option value="5">5 Guests</option>
</select>

<button class="btn btn-danger w-100 rounded-pill">
Reserve Table
</button>

</form>

</div>
</div>

<!-- MAP (Random Italian Street) -->
<div class="col-md-6">
<div class="map shadow-sm">
<iframe
src="https://www.google.com/maps?q=Via%20Roma%20Florence%20Italy&output=embed"
width="100%"
height="350">
</iframe>
</div>
</div>

</div>
</section>

<footer class="red-footer text-white mt-auto">
<div class="container text-center py-3 small">
Â© 2026 A La Pierre Restaurant
</div>
</footer>

<script>

const token = localStorage.getItem("token");

if (!token) {
 alert("Login required");
 window.location.href = "login.html";
}

function validateHours(time){
  const [h,m] = time.split(":").map(Number);
  return h >= 10 && h < 24;
}

async function reserve(){

 try{

   const selectedTime = time.value;

   if(!validateHours(selectedTime)){
     alert("Reservations allowed only between 10:00 and 24:00");
     return;
   }

   const res = await fetch("/api/reservations",{
     method:"POST",
     headers:{
       "Content-Type":"application/json",
       "Authorization":`Bearer ${token}`
     },
     body:JSON.stringify({
       date: date.value,
       time: selectedTime,
       guests: guests.value
     })
   });

   const data = await res.json();

   if(!res.ok) throw new Error(data.error);

   alert("Reservation confirmed!");

 }catch(err){
   alert(err.message);
 }

}

</script>

</body>
</html>
