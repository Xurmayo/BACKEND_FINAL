<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>My Reservations</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body { background:#f7f5f2; }
.red-nav { background:#8b0000; }
.card { border-radius:18px; }
</style>
</head>

<body>

<nav class="navbar navbar-dark red-nav">
<div class="container">
<span class="navbar-brand">üçΩÔ∏è My Reservations</span>
<a href="index.html" class="btn btn-outline-light">Home</a>
</div>
</nav>

<section class="container py-5">

<h3 class="mb-4">Your Bookings</h3>

<div id="reservationsList" class="list-group"></div>

</section>

<script>

const token = localStorage.getItem("token");

if (!token) {
 alert("Login first");
 window.location.href = "login.html";
}

async function loadReservations(){

 const res = await fetch("/api/reservations/my",{
   headers:{ Authorization:`Bearer ${token}` }
 });

 const data = await res.json();

 const box = document.getElementById("reservationsList");
 box.innerHTML="";

 if(data.length===0){
   box.innerHTML="<div class='text-muted'>No reservations yet</div>";
   return;
 }

 data.forEach(r=>{

   const item=document.createElement("div");
   item.className="list-group-item d-flex justify-content-between";

   item.innerHTML=`
     <div>
       üìÖ ${r.date} | ‚è∞ ${r.time} | üë• ${r.guests}
     </div>

     <button class="btn btn-sm btn-outline-danger"
       onclick="deleteReservation('${r._id}')">
       Cancel
     </button>
   `;

   box.appendChild(item);
 });
}

async function deleteReservation(id){

 if(!confirm("Cancel this reservation?")) return;

 await fetch(`/api/reservations/${id}`,{
   method:"DELETE",
   headers:{ Authorization:`Bearer ${token}` }
 });

 loadReservations();
}

loadReservations();

</script>


</body>
</html>
